# CFET2 开发计划 2020

<!-- keywords:CFET2;中子源控制系统;2020计划; -->
<!-- description:为了中子源年底有可靠的控制系统可以用CFET2必须要上要开展引用开发，要求是生产级别的软件，质量稳定性要求很高。 -->

## CFET2 Core

CFET2 Core 应该要固化下来了，很少有改动主要是以下几点：

### CFET2 Event

1. 目前传输的数据格式标准，需要在优化一下
2. 连接可靠新，重连机制，需要在确认一下，如果有更好的自动保证连接质量的 WS 的库可以考虑换一下
3. 目前远程事件仅仅支持再 CFET2 core 里面用，而且和订阅普通事件还有点不一样，需要统一一下，在做几个客户端，比如 JS 的在浏览器里面用的。
4. 订阅统一了以后，需要做一个 HTTP 的引导订阅机制，相当于把订阅做这个一个 webAPI 这样客户端写起来就简单很多

### CFET2 APP

1. 做到能够无需编译，很容易就能排至平且运行
2. 支持 Docker

## CFET2 OPI

1. 把原来的 Web 设计逻辑在整整，不合适的扔掉
2. opi 的外观再优化一下，按照这个原则来做：
   1. 分成两个模式：使用，编辑
   2. 在使用模式的时候极其简单，没有多余的按钮啥的
   3. 切换到编辑模式才能看到可以编辑的按钮，但是也要保持简单，和使用模式尽量接近，才算是 WYSIWYG。
   4. 或者是再 widget 右键，点击编辑，弹出一个新的窗口（window.open）然后编辑好保存，生效。
3. 要做一些新的 widget：
   1. ploty 那个做完美
   2. 仿造 LabVIEW 或着 css 做几个 widget：
      1. 模拟量显示
      2. 模拟量输入
      3. 数字量显示
      4. 数字量输入
      5. 数组类型的输入
      6. 字符串，JSON
      7. 方法的 Widget

## CFET2 DAQ

1. NI DAQ 做的完美一些，主要是配置那一套要做好，然后配合文档要有
2. 最关键的 HDF5 数据库那一套，包括 Python，Matlab 库，还有 Tag server，
3. tag server 要做界面

## CFET2 Logic

实现控制逻辑需要一些 CFET2 Thing 可以让用户编写用户逻辑：

1. 要做一个 Script Thing，可以让用户编写自己的控制逻辑，就是写个脚本可以把资源读出来然后判断，然后协会去，很简单的，关键是不需要编译，最好是直接 web 界面就可以改，不用重启直接保存生效
2. 要写一个状态机插件，很简单的和 J-TEXT EPICS 那个差不多

## CFET2 Device

这个用于和 CFET2 PLC 通讯的，简单协议
